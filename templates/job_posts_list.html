{% extends 'base.html' %}
{% block title %}Job Posts - Management{% endblock %}
{% load static %}
{% block content %}
<div class="container-fluid">
  <div class="row mb-4">
    <div class="col-12 d-flex justify-content-between align-items-center">
      <h1 class="h3 mb-0">Job Posts Management</h1>
      <a href="{% url 'add_job_post' %}" class="btn btn-primary">
        <i class="fas fa-briefcase"></i> Add Job Post
      </a>
    </div>
  </div>

  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">All Job Posts</h3>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table id="jobPostsTable" class="table table-bordered table-striped">
              <thead>
                <tr>
                  <th>Job Title</th>
                  <th>Company</th>
                  <th>Location</th>
                  <th>Employment Type</th>
                  <th>Salary Range</th>
                  <th>Requirements</th>
                  <th>Posted On</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <!-- Data will be populated by DataTables via AJAX -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
$(document).ready(function() {
  $('#jobPostsTable').DataTable({
    processing: true,
    serverSide: true,
    ajax: {
      url: "{% url 'job_posts_data' %}",
      type: 'GET',
      dataSrc: 'data',
      error: function(xhr, error, thrown) {
        console.log('DataTables error:', error);
        console.log('Response:', xhr.responseText);
      }
    },
    columns: [
      { data: "job_title" },
      { data: "company_name" },
      { data: "location" },
      { data: "employment_type" },
      { data: "salary_range" },
      { data: "requirements" },
      { data: "posted_on" },
      { 
        data: "actions", 
        orderable: false, 
        searchable: false,
        className: 'text-center'
      }
    ],
    language: {
      processing: "<i class='fas fa-spinner fa-spin'></i> Processing...",
      search: "_INPUT_",
      searchPlaceholder: "Search job posts...",
      lengthMenu: "Show _MENU_ job posts per page",
      info: "Showing _START_ to _END_ of _TOTAL_ job posts",
      infoEmpty: "Showing 0 to 0 of 0 job posts",
      infoFiltered: "(filtered from _MAX_ total job posts)",
      zeroRecords: "No matching job posts found",
      paginate: {
        first: "<i class='fas fa-angle-double-left'></i>",
        last: "<i class='fas fa-angle-double-right'></i>",
        next: "<i class='fas fa-angle-right'></i>",
        previous: "<i class='fas fa-angle-left'></i>"
      }
    },
    pageLength: 10,
    lengthMenu: [[5, 10, 25, 50, 100], [5, 10, 25, 50, 100]],
    responsive: true,
    ordering: true,
    order: [[5, 'desc']],
    searchDelay: 500
  });
});
</script>
{% endblock %}