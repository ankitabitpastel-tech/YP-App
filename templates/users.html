{% extends 'base.html' %}
{% block title %}Users - User Management{% endblock %}
{% load static %}
{% block content %}
<div class="container-fluid">
  <div class="row mb-4">
    <div class="col-12 d-flex justify-content-between align-items-center">
      <h1 class="h3 mb-0">Users Management</h1>
      <a href="{% url 'add_user' %}" class="btn btn-primary">
        <i class="fas fa-user-plus"></i> Add User
      </a>
    </div>
  </div>

  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">All Users</h3>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table id="usersTable" class="table table-bordered table-striped">
              <thead>
                <tr>
                  <th>Full Name</th>
                  <th>Username</th>
                  <th>Email</th>
                  <th>Phone No</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <!-- {% for user in users %} -->
                <!-- <tr>
                  <td>{{ user.full_name }}</td>
                  <td>{{ user.username }}</td>
                  <td>{{ user.email }}</td>
                  <td>{{ user.phone_no }}</td>
                  <td>
                    <div class="btn-group">
                      <a href="{% url 'user_details' user.md5_id %}" class="btn btn-sm btn-primary"><i class="fas fa-eye"></i></a>
                      <a href="{% url 'edit_user' user.md5_id %}" class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></a>
                      <a href="{% url 'delete_user' user.md5_id %}" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to delete this user?');"><i class="fas fa-user-times"></i></a>
                    </div>
                  </td>
                </tr>
                {% empty %}
                <tr>
                  <td colspan="5" class="text-center">No users found</td>
                </tr>
                {% endfor %} -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}

{% block extra_scripts %}

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap4.min.css">
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap4.min.js"></script>

<script>
$(document).ready(function() {
  $('#usersTable').DataTable({
    processing: true,
    serverSide: true,
    ajax: {
            url: "{% url 'users_data' %}",
            type: 'GET',
            dataSrc: 'data',
            error: function(xhr, error, thrown) {
              console.log('DataTables error:', error);
              // console.log('Response:', xhr.responseText);
          }

        },

    // ajax: "{% url 'users_data' %}", // Django endpoint returning JSON
    columns: [
      { data: "full_name" },
      { data: "username" },
      { data: "email" },
      { data: "phone_no" },
      { data: "actions", orderable: false, searchable: false }
    ],
    language: {
      search: "_INPUT_",
      searchPlaceholder: "Search here"
    },
    pageLength: 10,
    lengthMenu: [2, 5, 10, 25, 50, 100],
    responsive: true,
  });
});
</script>


{% endblock %}
